

##### Kafka面试题

###### 0. Kafka的用途有哪些？使用场景如何？
    目前Kafka已经定位为一个分布式流式处理平台，它以高吞吐、可持久化、可水平扩展、支持流数据处理等多种特性而被广泛使用。
    目前越来越多的开源分布式处理系统如Cloudera、Storm、Spark、Flink等都支持与Kafka集成。
    
    Kafka之所以受到越来越多的青睐，与它所“扮演”的三大角色是分不开的：
    1). 消息系统：Kafka 和传统的消息系统（也称作消息中间件）都具备系统解耦、冗余存储、流量削峰、缓冲、异步通信、扩展性、可恢复性等功能。
    与此同时，Kafka 还提供了大多数消息系统难以实现的消息顺序性保障及回溯消费的功能。·
    
    2). 存储系统：Kafka 把消息持久化到磁盘，相比于其他基于内存存储的系统而言，有效地降低了数据丢失的风险。也正是得益于Kafka 的消息持久化功能
    和多副本机制，我们可以把Kafka作为长期的数据存储系统来使用，只需要把对应的数据保留策略设置为“永久”或启用主题的日志压缩功能即可。
    
    3). 流式处理平台：Kafka 不仅为每个流行的流式处理框架提供了可靠的数据来源，还提供了一个完整的流式处理类库，比如窗口、连接、变换和聚合等各类操作。

###### 1. Kafka消息是采用Pull模式,还是Push模式？
    Kafka的customer应该从brokes拉取消息还是brokers将消息推送到consumer,也就是pull还push。
    Kafka遵循了一种大部分消息系统共同的传统的设计：producer将消息推送到broker,consumer从broker拉取消息。

    消息系统都致力于让consumer以最大的速率最快速的消费消息,push模式下,当broker推送的速率远大于consumer消费的速率时,
    consumer恐怕就要崩溃了。最终 Kafka还是选取了传统的pull模式。
    Pull模式中consumer可以自主决定是否批量的从broker拉取数据。
    
    Pull有个缺点是,如果broker没有可供消费的消息,将导致consumer不断在循环中轮询,
    直到新消息到达。为了避免这点,Kafka 有个参数可以让consumer阻塞知道新消息到达。

###### 2. Kafka一致性语义
    At Least Once：消息不丢,但可能重复
    At Most Once：消息会丢,但不会重复
    Exactly Once：消息不丢,也不重复。

###### 3. Kafka数据顺序
    一个消费者组里它的内部是有序的。
    消费者组与消费者组之间是无序的。

###### 4. Kafka中的ISR、AR代表什么？
    分区中的所有副本统称为AR（Assigned Replicas）。
    所有与leader副本保持一定程度同步的副本（包括leader副本在内）组成ISR（In-Sync Replicas），ISR集合是AR集合中的一个子集。
    与leader副本同步滞后过多的副本（不包括leader副本）组成OSR（Out-of-Sync Replicas），由此可见，AR=ISR+OSR。

###### 5. Kafka中的HW、LEO、LSO、LW等分别代表什么？


###### 6. Kafka中的分区器、序列化器、拦截器是否了解？它们之间的处理顺序是什么？


###### 7. 有哪些情况会造成重复消费?


###### 8. 有哪些情况会造成漏消费?


###### 9. 消费者提交消费位移时提交的是当前消费到的最新消息的offset还是offset+1?
 
###### 10. KafkaConsumer是非线程安全的，那么怎么样实现多线程消费？


###### 11. 当你使用kafka-topics.sh创建（删除）了一个topic之后，Kafka背后会执行什么逻辑？


###### 12. 简述消费者与消费组之间的关系


###### 13. 创建topic时如何选择合适的分区数？


###### 14. Kafka目前有哪些内部topic，它们都有什么特征？各自的作用又是什么？


###### 15. topic的分区数可不可以增加？如果可以怎么增加？如果不可以，那又是为什么？



###### 16. topic的分区数可不可以减少？如果可以怎么减少？如果不可以，那又是为什么？


###### 17. 优先副本是什么？它有什么特殊的作用？
###### 18. Kafka有哪几处地方有分区分配的概念？简述大致的过程及原理
###### 19. 简述Kafka的日志目录结构
           
###### 20. Kafka中有那些索引文件？
###### 21. 如果我指定了一个offset，Kafka怎么查找到对应的消息？
           
###### 22. 如果我指定了一个timestamp，Kafka怎么查找到对应的消息？
###### 23. 聊一聊你对Kafka的Log Retention的理解
###### 24. 聊一聊你对Kafka的Log Compaction的理解
###### 25. 聊一聊你对Kafka底层存储的理解（页缓存、内核层、块层、设备层）
###### 26. 聊一聊Kafka的延时操作的原理
###### 27. 聊一聊Kafka控制器的作用
###### 28. 消费再均衡的原理是什么？（提示：消费者协调器和消费组协调器）
###### 29. Kafka中的幂等是怎么实现的
###### 30. Kafka中的事务是怎么实现的

###### 31. Kafka中有哪些地方需要选举？这些地方的选举策略又有哪些？
###### 32. 失效副本是指什么？有那些应对措施？
###### 33. 多副本下，各个副本中的HW和LEO的演变过程
           
###### 34. 为什么Kafka不支持读写分离？
###### 35. Kafka在可靠性方面做了哪些改进？（HW, LeaderEpoch）
###### 36. Kafka中怎么实现死信队列和重试队列？
###### 37. Kafka中的延迟队列怎么实现
###### 38. Kafka中怎么做消息审计？
###### 39. Kafka中怎么做消息轨迹？
###### 40. Kafka中有那些配置参数比较有意思？聊一聊你的看法
           
###### 41. Kafka中有那些命名比较有意思？聊一聊你的看法
###### 42. Kafka有哪些指标需要着重关注？
###### 43. 怎么计算Lag？
###### 44. Kafka的那些设计让它有如此高的性能？
###### 45. Kafka有什么优缺点？
###### 46. 还用过什么同质类的其它产品，与Kafka相比有什么优缺点？
###### 47. 为什么选择Kafka?

###### 48. 在使用Kafka的过程中遇到过什么困难？怎么解决的？
###### 49. 怎么样才能确保Kafka极大程度上的可靠性？
###### 50. 聊一聊你对Kafka生态的理解

